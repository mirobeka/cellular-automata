// Generated by CoffeeScript 1.6.3
(function() {
  var addOption, addSection, insertOption, insertSection, optionHtml, removeOption, sectionHtml;

  addOption = function(event) {
    var inputTag, opt, option, section;
    section = $(event.target).attr('data-section');
    inputTag = $(event.target).siblings('input[name="optionName"]').get(0);
    option = $(inputTag).val();
    console.log("Adding option " + option + " in section " + section);
    $(inputTag).val("");
    opt = optionHtml(section, option);
    return insertOption(section, opt);
  };

  addSection = function(event) {
    var inputTag, sct, section;
    inputTag = $(event.target).siblings('input[name="sectionName"]').get(0);
    console.log(inputTag);
    section = $(inputTag).val();
    console.log("adding section " + section);
    sct = sectionHtml(section);
    $(inputTag).val("");
    return insertSection(sct);
  };

  removeOption = function(event) {
    var option, section;
    section = $(event.target).attr('data-section');
    option = $(event.target).attr('data-option');
    console.log("removing " + section + "." + option);
    return $("." + section + " > ." + option).remove();
  };

  optionHtml = function(section, option) {
    return "<div class=\"field " + option + "\">\n<label>" + option + "</label>\n<div class=\"ui action input\">\n    <input type=\"text\" name=\"" + section + "." + option + "\" placeholder=\"Enter value\">\n    <div class=\"ui removeOption tiny red button\" data-option=\"" + option + "\" data-section=\"" + section + "\">\n        <i class=\"ui minus icon\"></i>\n    </div>\n</div>\n</div>";
  };

  sectionHtml = function(section) {
    return "<div class=\"ui horizontal icon divider\">\n  <i class=\"ellipsis horizontal icon\"></i>\n</div>\n<div class=\"" + section + " last\">\n\n    <h3>" + section + "</h3>\n\n      <div class=\"ui three column grid\">\n        <div class=\"column\">\n          <div class=\"ui action input\">\n            <input type=\"text\" name=\"optionName\" placeholder=\"Option name\">\n            <div class=\"ui addOption button\" data-section=\"" + section + "\">\n                <i class=\"ui plus icon\"></i>\n            </div>\n          </div>\n        </div>\n\n      </div>";
  };

  insertOption = function(section, htmlToInsert) {
    var newOption;
    section = $("." + section);
    newOption = $(htmlToInsert);
    newOption.bind("click", addOption);
    return newOption.insertBefore(section.find(".ui.three.column.grid"));
  };

  insertSection = function(htmlToInsert) {
    var lastSection, newSection;
    lastSection = $(".last");
    newSection = $(htmlToInsert);
    newSection.insertAfter(".last");
    newSection.find(".ui.addOption.button").bind("click", addOption);
    return lastSection.removeClass('last');
  };

  $(document).ready(function() {
    new FormSubmitter(".ui.update.form", "PUT", ".", function(response) {
      return window.location.assign(response);
    });
    new FormSubmitter(".ui.delete.form", "DELETE", ".", function(response) {
      return window.location.assign(response);
    });
    $('.addSection').bind('click', addSection);
    $('.addOption').bind('click', addOption);
    return $('.removeOption').bind('click', removeOption);
  });

}).call(this);
