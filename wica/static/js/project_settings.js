// Generated by CoffeeScript 1.6.3
(function() {
  var addOption, addSection, insertOption, insertSection, optionHtml, sectionHtml;

  addOption = function(event) {
    var inputTag, opt, option, section;
    section = $(event.target).attr('data-section');
    inputTag = $(event.target).siblings('input[name="optionName"]').get(0);
    option = $(inputTag).val();
    console.log("adding " + section + "." + option);
    opt = optionHtml(section, option);
    return insertOption(section, opt);
  };

  addSection = function(event) {
    var inputTag, sct, section;
    console.log(event);
    inputTag = $(event.target).siblings('input[name="sectionName"]').get(0);
    console.log(inputTag);
    section = $(inputTag).val();
    console.log("adding section " + section);
    sct = sectionHtml(section);
    return insertSection(sct);
  };

  optionHtml = function(section, option) {
    return "<div class=\"field\">\n<label>" + option + "</label>\n<input type=\"text\" name=\"" + section + "." + option + "\" placeholder=\"Enter value\">\n</div>";
  };

  sectionHtml = function(section) {
    return "<div class=\"" + section + " last\">\n<h3>" + section + "</h3>\n  <div class=\"ui three column grid\">\n    <div class=\"column\">\n      <div class=\"ui action input\">\n        <input type=\"text\" name=\"optionName\" placeholder=\"Option name\">\n        <div class=\"ui addOption button\" data-section=\"" + section + "\">Add</div>\n      </div>\n    </div>\n  </div>";
  };

  insertOption = function(section, htmlToInsert) {
    var newOption;
    section = $("." + section);
    newOption = $(htmlToInsert);
    newOption.bind('click', addOption);
    return newOption.insertBefore(section.find('.ui.three.column.grid'));
  };

  insertSection = function(htmlToInsert) {
    var lastSection, newSection;
    lastSection = $('.last');
    newSection = $(htmlToInsert);
    newSection.bind('click', addSection);
    newSection.appendTo('.last');
    return lastSection.removeClass('last');
  };

  $(document).ready(function() {
    new FormSubmitter(".ui.update.form", "PUT", ".", function(response) {
      return window.location.assign(response);
    });
    new FormSubmitter(".ui.delete.form", "DELETE", ".", function(response) {
      return window.location.assign(response);
    });
    $('.addSection').bind('click', addSection);
    return $('.addOption').bind('click', addOption);
  });

}).call(this);
